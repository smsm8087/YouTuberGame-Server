@page "/"
@inject AdminAuthService AuthService
@inject AdminApiClient ApiClient
@inject NavigationManager Navigation

<PageTitle>ëŒ€ì‹œë³´ë“œ</PageTitle>

@if (!AuthService.IsAuthenticated)
{
    <p>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤...</p>
    return;
}

<h1>ğŸ“Š ëŒ€ì‹œë³´ë“œ</h1>

@if (dashboardData == null)
{
    <p><em>ë°ì´í„° ë¡œë”© ì¤‘...</em></p>
}
else
{
    <div class="row mt-4">
        <div class="col-md-3">
            <div class="card text-white bg-primary mb-3">
                <div class="card-body">
                    <h5 class="card-title">ì´ ìœ ì €</h5>
                    <p class="card-text display-4">@dashboardData.TotalUsers</p>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card text-white bg-success mb-3">
                <div class="card-body">
                    <h5 class="card-title">DAU (24ì‹œê°„)</h5>
                    <p class="card-text display-4">@dashboardData.DailyActiveUsers</p>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card text-white bg-info mb-3">
                <div class="card-body">
                    <h5 class="card-title">ì´ ê°€ì±  íšŸìˆ˜</h5>
                    <p class="card-text display-4">@dashboardData.TotalGachaDraws</p>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card text-white bg-warning mb-3">
                <div class="card-body">
                    <h5 class="card-title">ì—…ë¡œë“œ ì½˜í…ì¸ </h5>
                    <p class="card-text display-4">@dashboardData.TotalContentUploaded</p>
                </div>
            </div>
        </div>
    </div>

    <div class="alert alert-secondary mt-3">
        <small>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: @dashboardData.LastUpdated.ToString("yyyy-MM-dd HH:mm:ss")</small>
    </div>
}

@code {
    private DashboardData? dashboardData;

    protected override async Task OnInitializedAsync()
    {
        if (!AuthService.IsAuthenticated)
        {
            Navigation.NavigateTo("/login");
            return;
        }

        dashboardData = await ApiClient.GetDashboardAsync();
    }
}
